<!DOCTYPE html>
<!-- [html-validate-disable no-trailing-whitespace] -->
<html lang="nl">

<head>
   <title>WPF layout | C# cheat sheets</title>
   <meta charset="UTF-8">
   <link rel="stylesheet" href="styles.css">
</head>

<body class="language-cs showpro">
   <div id="mode">
      <span>n00b</span>
      <label class="switch">
         <input type="checkbox" checked>
         <span class="slider round"></span>
      </label>
      <span>pro</span>
   </div>
   <nav class="site__nav">
      <a href="01_csharpsyntax.html" class="main__thumb" title="01. C# syntax">
         <p class="thumb__title">01. C# syntax</p>
         <img class="thumb__visual" src="img/01_csharpsyntax/icon.jpg" alt="">
      </a>
      <a href="02_dotnetclasses.html" class="main__thumb" title="02. .NET classes">
         <p class="thumb__title">02. .NET classes</p>
         <img class="thumb__visual" src="img/02_dotnetclasses/icon.png" alt="">
      </a>
      <a href="03_wpfcontrols.html" class="main__thumb" title="03. WPF controls">
         <p class="thumb__title">03. WPF controls</p>
         <img class="thumb__visual" src="img/03_wpfcontrols/icon.png" alt="">
      </a>
      <a href="04_wpflayout.html" class="main__thumb pro" title="04. WPF layout">
         <p class="thumb__title">04. WPF layout</p>
         <img class="thumb__visual" src="img/04_wpflayout/icon2.png" alt="">
      </a>
      <a href="05_filesfolders.html" class="main__thumb pro active">
         <p class="thumb__title">05. bestanden &amp; mappen</p>
         <img class="thumb__visual" src="img/05_filesfolders/icon.png" alt="">
      </a>
      <a href="06_oo_programmatie.html" class="main__thumb pro">
         <p class="thumb__title">06. OO programmatie</p>
         <img class="thumb__visual" src="img/06_oo_programmatie/icon.jpg" alt="">
      </a>
      <a href="07_sql_databanken.html" class="main__thumb pro">
         <p class="thumb__title">07. SQL databanken</p>
         <img class="thumb__visual" src="img/07_sql_databanken/icon.png" alt="">
      </a>
   </nav>
   <h1>05. Bestanden en mappen</h1>
   <div id="toc"></div>
   <main>

      <h2>Namespaces en klassen</h2>
      <p>In .NET zit de functionaliteit voor het werken met bestanden en mappen verspreid over heel wat namespaces en klassen.</p>
      <h3>Voor paden</h3>
      <table class="light">
         <thead>
            <tr>
               <th scope="col">Klasse</th>
               <th scope="col">Omschrijving</th>
            </tr>
         </thead>
         <tbody>
            <tr>
               <td><code>System.IO.Path</code></td>
               <td>werken met paden; methodes <code>Combine()</code>, <code>GetFileNameWithoutExtension()</code>, <code>GetDirectoryName()</code>...</td>
            </tr>
            <tr>
               <td><code>System.Environment</code></td>
               <td>omgevingsspecifieke paden; methodes <code>GetFolderPath()</code>, properties <code>SpecialFolder.Desktop</code>, <code>SpecialFolder.MyDocuments</code>...</td>
            </tr>
         </tbody>
      </table>
      <h3>Voor bestanden en mappen</h3>
      <p>De meeste klassen voor het werken met bestanden en mappen vind je in de <code>System.IO</code> namespace:</p>
      <table class="light">
         <thead>
            <tr>
               <th scope="col">Klasse</th>
               <th scope="col">Omschrijving</th>
            </tr>
         </thead>
         <tbody>
            <tr>
               <td><code>Directory</code></td>
               <td>werken met mappen; methodes <code>GetDirectories()</code>, <code>GetFiles()</code>, <code>Delete()</code>, <code>CreateDirectory()</code>...</td>
            </tr>
            <tr>
               <td><code>DirectoryInfo</code></td>
               <td>map informatie opvragen; properties <code>FullName</code>, <code>Name</code>, <code>Parent</code>, <code>Exists</code>...</td>
            </tr>
            <tr>
               <td><code>File</code></td>
               <td>werken met bestanden; methodes <code>ReadAllText()</code>, <code>WriteAllText()</code>, <code>Copy()</code>, <code>Delete()</code>...</td>
            </tr>
            <tr>
               <td><code>FileInfo</code></td>
               <td>bestand informatie opvragen; properties <code>Name</code>, <code>Extension</code>, <code>Directory</code>, <code>Exists</code>, <code>Length</code>...</td>
            </tr>
            <tr class="pro">
               <td><code>StreamReader</code></td>
               <td>bestanden streamend lezen (geheugenvriendelijk, enkel nodig bij zeer grote bestanden)</td>
            </tr>
            <tr class="pro">
               <td><code>StreamWriter</code></td>
               <td>bestanden streamend schrijven (geheugenvriendelijk, enkel nodig bij zeer grote bestanden)</td>
            </tr>
            <tr>
               <td><code>System.IO.Path</code></td>
               <td>werken met paden; methodes <code>Combine()</code>, <code>GetFileNameWithoutExtension()</code>, <code>GetDirectoryName()</code>...</td>
            </tr>
         </tbody>
      </table>
      <h3>Voor dialoogvensters</h3>
      <p>Allerhande dialoogvensters vind je in <code>Microsoft.Win32</code>, <code>System.Windows</code> en <code>System.Windows.Forms</code>:</p>
      <table class="light">
         <thead>
            <tr>
               <th scope="col">Namespace</th>
               <th scope="col">Klasse</th>
               <th scope="col">Omschrijving</th>
            </tr>
         </thead>
         <tbody>
            <tr>
               <td>Microsoft.Win32</td>
               <td><code>OpenFileDialog</code></td>
               <td>dialoogvenster om bestanden te openen</td>
            </tr>
            <tr>
               <td>Microsoft.Win32</td>
               <td><code>OpenFolderDialog</code></td>
               <td>dialoogvenster om mappen te openen</td>
            </tr>
            <tr>
               <td>Microsoft.Win32</td>
               <td><code>SaveFileDialog</code></td>
               <td>dialoogvenster om bestanden op te slaan &mdash; pas beschikbaar vanaf .NET8!</td>
            </tr>
            <tr>
               <td>System.Windows</td>
               <td><code>MessageBox</code></td>
               <td>foutmeldings-, waarschuwings- en berichtvensters</td>
            </tr>
            <tr>
               <td>System.Windows.Forms</td>
               <td><code>FolderBrowserDialog</code></td>
               <td>ouderwets dialoogvenster om een map te kiezen</td>
            </tr>
         </tbody>
      </table>

      <h2>Paden</h2>
      <h3>Systeemmappen vinden</h3>
      <p>Op elke computer is de fysieke locatie voor systeemmappen als Desktop, My Documents... verschillend. Gebruik daarom altijd de <code>Environment.SpecialFolder</code> enumeratie:</p>
      <pre><code>string desktopFolder = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);</code></pre>
      <p>Andere typische voorbeelden zijn My Documents, My Pictures enz...:</p>
      <p><img src="img/05_filesfolders/specialfolders.png" alt="" class="w-600"></p>

      <h3>Paden combineren</h3>
      <p>Gebruik best altijd <code>System.IO.Path.Combine()</code> om paden te combineren:</p>
      <pre><code>string folderPath = Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments);
string filePath = System.IO.Path.Combine(folderPath, "textfiles\\myfile.txt");
Console.WriteLine(filePath);
</code></pre>
<figure class="console">
   <pre>C:\Users\rogie\Documents\textfiles\myfile.txt</pre>
   <figcaption>resultaat in de console</figcaption>
</figure>

      <h2>Bestanden</h2>
      <h3>Overzicht</h3>
      <p>Alle methodes om bestanden te lezen, schrijven, bewerken enz... vind je in de <code>File</code> klasse:</p>
      <table class="light">
         <thead>
            <tr>
               <th scope="col">Methode</th>
               <th scope="col">Omschrijving</th>
            </tr>
         </thead>
         <tbody>
            <tr>
               <td><code>AppendAllLines()</code></td>
               <td>array of lijst toevoegen aan een bestand</td>
            </tr>
            <tr>
               <td><code>AppendAllText()</code></td>
               <td>tekst toevoegen aan een bestand</td>
            </tr>
            <tr>
               <td><code>Copy()</code></td>
               <td>kopieer een bestand</td>
            </tr>
            <tr>
               <td><code>Delete()</code></td>
               <td>verwijder een bestand</td>
            </tr>
            <tr>
               <td><code>Exists()</code></td>
               <td>controleert of een bestand bestaat</td>
            </tr>
            <tr>
               <td><code>Move()</code></td>
               <td>verplaats een bestand</td>
            </tr>
            <tr>
               <td><code>ReadAllLines()</code></td>
               <td>bestand inlezen in een <code>string[]</code> array</td>
            </tr>
            <tr>
               <td><code>ReadAllText()</code></td>
               <td>bestand inlezen in een <code>string</code></td>
            </tr>
            <tr>
               <td><code>WriteAllLines()</code></td>
               <td>array of lijst keer schrijven naar een bestand</td>
            </tr>
            <tr>
               <td><code>WriteAllText()</code></td>
               <td>tekst schrijven naar een bestand</td>
            </tr>
         </tbody>
      </table>
      <p>Properties om bestandsinformatie op te vragen vind je in de <code>FileInfo</code> klasse:</p>
      <table class="light">
         <thead>
            <tr>
               <th scope="col">Property</th>
               <th scope="col">Omschrijving</th>
            </tr>
         </thead>
         <tbody>
            <tr>
               <td><code>Directory</code></td>
               <td>map van het bestand (volledig pad)</td>
            </tr>
            <tr>
               <td><code>DirectoryName</code></td>
               <td>mapnaam van het bestand</td>
            </tr>
            <tr>
               <td><code>Exists</code></td>
               <td>bestaat het of niet (<code>true</code> of <code>false</code>)</td>
            </tr>
            <tr>
               <td><code>Extension</code></td>
               <td>extensie (met punt)</td>
            </tr>
            <tr>
               <td><code>FullName</code></td>
               <td>volledig pad</td>
            </tr>
            <tr>
               <td><code>Length</code></td>
               <td>bestandsgrootte in bytes</td>
            </tr>
            <tr>
               <td><code>Name</code></td>
               <td>bestandsnaam</td>
            </tr>
         </tbody>
      </table>

      <h3>Code voorbeelden</h3>
      <h4>Bestand inlezen in een string</h4>
   <pre><code>string folderPath = Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments);
string filePath = System.IO.Path.Combine(folderPath, "myfile.txt");

string inhoud = File.ReadAllText(filePath); // lees tekstinhoud bestand in
</code></pre>
      <h4>Bestand inlezen in een array</h4>
   <pre><code>string folderPath = Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments);
string filePath = System.IO.Path.Combine(folderPath, "myfile.txt");

string[] regels = File.ReadAllLines(filePath); // lees regels bestand in
</code></pre>
      <h4>String schrijven naar een bestand</h4>
   <pre><code>string folderPath = Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments);
string filePath = System.IO.Path.Combine(folderPath, "myfile.txt");
string inhoud = @"Dit is regel 1
Dit is regel 2";

File.WriteAllText(filePath, inhoud); // nieuw bestand als het nog niet bestaat
</code></pre>
      <h4>Array of lijst schrijven naar een bestand</h4>
      <pre><code>string folderPath = Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments);
string filePath = System.IO.Path.Combine(folderPath, "myfile.txt");
string[] regels = new string[] { "Dit is lijn 1", "Dit is lijn 2" };

File.WriteAllLines(filePath, regels); // nieuw bestand als het nog niet bestaat
</code></pre>
      <h4>Tekst toevoegen aan een bestaand bestand</h4>
      <p>Naast <code>File.WriteAllText()</code> en <code>File.WriteAllLines()</code> bestaan er ook methodes <code>File.AppendAllText()</code> en <code>File.AppendAllLines()</code>:</p>
      <pre><code>string folderPath = Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments);
string filePath = System.IO.Path.Combine(folderPath, "myfile.txt");

File.AppendAllText(filePath, $"Am no an listening depending up believing{Environment.NewLine}");</code></pre>
      <pre><code>string folderPath = Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments);
string filePath = System.IO.Path.Combine(folderPath, "myfile.txt");
string[] regels = new string[] { "Dit is lijn 3", "Dit is lijn 4" };

File.AppendAllLines(filePath, regels); 
</code></pre>
      <h4>Controleren of een bestand bestaat</h4>
      <pre><code>string folderPath = Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments);
string filePath = System.IO.Path.Combine(folderPath, "mycontacts.txt");

if (!File.Exists(filePath)) 
{
   // ...
}</code></pre>

      <h4>Informatie opvragen</h4>
      <p>Schematisch codevoorbeeld:</p>
      <pre><code>FileInfo fi = new FileInfo(someFilePath);
Console.WriteLine($@"
    bestandsnaam: {fi.Name}
    extensie: {fi.Extension}
    gemaakt op: {fi.CreationTime.ToString()}
    mapnaam: {fi.Directory.Name}
");</code></pre>
      <div class="pro">

      <h4>Streamend lezen en schrijven</h4>
      <p>Alle vorige methodes laden de hele bestandsinhoud in één keer in het geheugen in. Voor heel grote bestanden is dat niet efficiënt. In die (uitzonderlijke) gevallen kan je gebruik maken van <code>StreamReader</code> en <code>StreamWriter</code>. </p>
      <p><code>StreamReader</code> voorbeeld (zoeken naar een tekst):</p>
      <pre><code>List&lt;string&gt; foundLines = new List&lt;string&gt;();
string folderPath = Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments);
string filePath = System.IO.Path.Combine(folderPath, "mycontacts.txt");

// open stream and start reading
using (StreamReader reader = File.OpenText(filePath)) {
    string line;
    while ((line = reader.ReadLine()) != null) {
        if (line.Contains("jennifer")) foundLines.Add(line);
    }
} // stream closes automatically
</code></pre>
      <p><code>StreamWriter</code> voorbeeld:</p>
      <pre><code>// prepare
string folderPath = Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments);
string filePath = System.IO.Path.Combine(folderPath, "myfile.txt");

// open stream and start writing
using (StreamWriter writer = File.CreateText(filePath)) {
    writer.WriteLine("Dit is lijn 1");
    writer.WriteLine("Dit is lijn 2");
} // stream closes automatically
</code></pre>
      <p>In praktijk zul je streamend lezen of schrijven in deze cursus nooit nodig hebben.</p>
      </div>

      <h2>Mappen</h2>
      <h3>Overzicht</h3>
      <p>Alle methodes om te werken met mappen vind je in de <code>Directory</code> klasse:</p>
      <table class="light">
         <thead>
            <tr>
               <th scope="col">Methode</th>
               <th scope="col">Omschrijving</th>
            </tr>
         </thead>
         <tbody>
            <tr>
               <td><code>CreateDirectory()</code></td>
               <td>maak een map aan</td>
            </tr>
            <tr>
               <td><code>Delete()</code></td>
               <td>verwijder een map</td>
            </tr>
            <tr>
               <td><code>Exists()</code></td>
               <td>controleert of een map bestaat</td>
            </tr>
            <tr>
               <td><code>GetDirectories()</code></td>
               <td>vraag een lijst submappen in de map op</td>
            </tr>
            <tr>
               <td><code>GetFiles()</code></td>
               <td>vraag een lijst bestanden in de map op</td>
            </tr>
         </tbody>
      </table>
      <p>Properties om mapinformatie op te vragen vind je in de <code>DirectoryInfo</code> klasse:</p>
      <table class="light">
         <thead>
            <tr>
               <th scope="col">Property</th>
               <th scope="col">Omschrijving</th>
            </tr>
         </thead>
         <tbody>
            <tr>
               <td><code>Exists</code></td>
               <td>bestaat het of niet (<code>true</code> of <code>false</code>)</td>
            </tr>
            <tr>
               <td><code>FullName</code></td>
               <td>volledig pad</td>
            </tr>
            <tr>
               <td><code>Name</code></td>
               <td>bestandsnaam</td>
            </tr>
            <tr>
               <td><code>Parent</code></td>
               <td>basismap (volledig pad)</td>
            </tr>
         </tbody>
      </table>

      <h3>Code voorbeelden</h3>
      <h4>Map inhoud lezen</h4>
      <p>Gebruik de methodes <code>GetDirectories</code> en <code>GetFiles</code>. Voorbeeld voor het lezen van de bestanden op de desktop:</p>
      <pre><code>string desktop = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);

string[] files = Directory.GetFiles(desktop); // lijst van bestanden (volledig pad)
foreach (string file in files)
{
    Console.WriteLine(new FileInfo(file).Name); // geef enkel de namen weer
}</code></pre>
      <h4>Controleren of een map bestaat</h4>
      <pre><code>string folderPath = Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments);
string startfolder = System.IO.Path.Combine(folderPath, "myfolder");

if (!Directory.Exists(startfolder)) 
{
   // ...
}</code></pre>
      <h4>Informatie opvragen</h4>
      <p>Schematisch codevoorbeeld:</p>
      <pre><code>DirectoryInfo di = new DirectoryInfo(someDirectoryPath);
Console.WriteLine($@"
    mapnaam: {di.Name}
    basismap: {di.Parent.Name}
    gemaakt op: {di.CreationTime.ToString()}
");</code></pre>

      <h2>Dialoogvensters</h2>
      <h3>OpenFileDialog</h3>
      <p>Schematisch:</p>
      <pre><code>OpenFileDialog dialog = new OpenFileDialog();
dialog.InitialDirectory = Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments);
dialog.Filter = "Tekstbestanden|*.TXT;*.TEXT";
string chosenFileName;
bool? dialogResult = dialog.ShowDialog();
if (dialogResult == true) { 
   // user picked a file and pressed OK
   chosenFileName = dialog.FileName; 
} else {
    // user cancelled or escaped dialog window
}
</code></pre>
      <p><img src="img/05_filesfolders/openfiledialog.png" alt="" class="w-550"></p>
      <h3>OpenFolderDialog</h3>
      <p><strong>Let op!</strong> Tot voor kort bestond (zeer vreemd genoeg) dit dialoogvenster niet. Het is pas toegevoegd sinds .NET8, dus werkt niet in oudere projecttypes als WPF .NET Framework! Daar werd je verondersteld third party oplossingen te gebruiken. Schematisch:</p>
      <pre><code>OpenFolderDialog dialog = new OpenFolderDialog();
dialog.InitialDirectory = Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments);
string chosenFolderName;
bool? dialogResult = dialog.ShowDialog();
if (dialogResult == true)
{
    // user picked a folder and pressed OK
    chosenFolderName = dialog.FolderName;
}
else
{
    // user cancelled or escaped dialog window
}</code></pre>
      <p><img src="img/05_filesfolders/openfolderdialog.png" alt="" class="w-550"></p>
      <h3>SaveFileDialog</h3>
      <p>Schematisch:</p>
      <pre><code>SaveFileDialog dialog = new SaveFileDialog();
dialog.InitialDirectory = Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments);
dialog.Filter = "Tekstbestanden|*.TXT;*.TEXT";
dialog.FileName = "savedfile.txt";
if (dialog.ShowDialog() == true) {
    File.WriteAllText(dialog.FileName, "tekstinhoud hier");
} else {
    // user pressed Cancel or escaped dialog window
}
</code></pre>
      <p><img src="img/05_filesfolders/savefiledialog.png" alt="" class="w-550"></p>
      <h3>MessageBox</h3>
      <p>Zie <a href="02_dotnetclasses.html#messagebox">.NET classes - MessageBox</a></p>


   </main>
   <a aria-label="up" id="up" href="#top"><span class="fas fa-chevron-circle-up"></span></a>
   <script src="vendor/prism.js"></script>
   <script src="js/mode.js"></script>
   <script src="js/scripts.js"></script>

</body>

</html>