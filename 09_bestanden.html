<!DOCTYPE html>
<!-- [html-validate-disable no-trailing-whitespace] -->
<html lang="nl">

<head>
   <title>Bestanden en mappen | C# cursus</title>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <link rel="stylesheet" href="common/styles.css">
   <link rel="stylesheet" href="css/styles.css">
   <link rel="icon" href="favicon.ico" type="image/x-icon">
</head>

<body class="prism prism-vslight language-cs showpro" id="top">
   <div id="mode">
      <span>n00b</span>
      <label class="switch">
         <input type="checkbox" checked>
         <span class="slider round"></span>
      </label>
      <span>pro</span>
   </div>
   <nav class="site__nav">
      <a href="01_basis.html" class="main__thumb">
         <p class="thumb__title">01. basis</p>
         <img class="thumb__visual" src="img/01_basis/icon.png" alt="">
      </a>
      <a href="02_variabelen.html" class="main__thumb">
         <p class="thumb__title">02. variabelen</p>
         <img class="thumb__visual" src="img/02_variabelen/icon.jpg" alt="">
      </a>
      <a href="03_selecties.html" class="main__thumb">
         <p class="thumb__title">03. selecties</p>
         <img class="thumb__visual" src="img/03_selecties/icon.jpg" alt="">
      </a>
      <a href="04_iteraties.html" class="main__thumb">
         <p class="thumb__title">04. iteraties</p>
         <img class="thumb__visual" src="img/04_iteraties/icon.jpg" alt="">
      </a>
      <a href="05_methodes.html" class="main__thumb">
         <p class="thumb__title">05. methodes</p>
         <img class="thumb__visual" src="img/05_methodes/icon.jpg" alt="">
      </a>
      <a href="06_arrays.html" class="main__thumb">
         <p class="thumb__title">06. arrays</p>
         <img class="thumb__visual" src="img/06_arrays/icon.jpg" alt="">
      </a>
      <a href="07_wpf.html" class="main__thumb">
         <p class="thumb__title">07. WPF</p>
         <img class="thumb__visual" src="img/07_wpf/icon.png" alt="">
      </a>
      <a href="08_layout.html" class="main__thumb pro">
         <p class="thumb__title">08. layout</p>
         <img class="thumb__visual" src="img/08_layout/icon2.png" alt="">
      </a>
      <a href="09_bestanden.html" class="main__thumb pro active">
         <p class="thumb__title">09. bestanden</p>
         <img class="thumb__visual" src="img/09_bestanden/icon.png" alt="">
      </a>
      <a href="10_classes.html" class="main__thumb pro">
         <p class="thumb__title">10. classes</p>
         <img class="thumb__visual" src="img/10_classes/icon.png" alt="">
      </a>
      <a href="11_static_enum.html" class="main__thumb pro">
         <p class="thumb__title">11. static en enum</p>
         <img class="thumb__visual" src="img/11_static_enum/icon.png" alt="">
      </a>
      <a href="12_overerving.html" class="main__thumb pro">
         <p class="thumb__title">12. overerving</p>
         <img class="thumb__visual" src="img/12_overerving/icon.jpg" alt="">
      </a>
      <a href="13_databanken.html" class="main__thumb pro">
         <p class="thumb__title">13. databanken</p>
         <img class="thumb__visual" src="img/13_databanken/icon.png" alt="">
      </a>
      <a href="A_dotnet.html" class="main__thumb">
         <p class="thumb__title">appendix: .NET</p>
         <img class="thumb__visual" src="img/A_dotnet/icon.png" alt="">
      </a>
      <a href="B_oo_samenvatting.html" class="main__thumb pro">
         <p class="thumb__title">appendix: OO<br>samenvatting</p>
         <img class="thumb__visual" src="img/B_oo_samenvatting/icon.png" alt="">
      </a>
   </nav>
   <h1>09. Bestanden en mappen</h1>
   <p class="othercourses"><small>Dit hoofdstuk is onderdeel van de cursus <a href="https://rogiervdl.github.io/CS-course/">C#</a>. Andere cursussen in dezelfde reeks: <a href="https://rogiervdl.github.io/HTML-course/">HTML</a>, <a href="https://rogiervdl.github.io/CSS-course/">CSS</a>, <a href="https://rogiervdl.github.io/JS-course/">Javascript</a>, <a href="https://rogiervdl.github.io/DEVENV-course/">Ontwikkelomgeving</a>.</small></p>
   <div id="toc"></div>
   <main>

      <!-- VIDEO -->
      <h2>Youtube: bestanden &amp; excepties</h2>
      <div class="flexcontainer youtubecontainer">
         <iframe class="youtube" width="600" height="378" src="https://www.youtube.com/embed/j-ECPszC8x8" title="YouTube video player" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
         <figure class="print">
            <a href="https://www.youtube.com/watch?v=j-ECPszC8x8"><img src="img//09_bestanden/youtube-ooad-bestanden.png" alt="" class="w-500"></a>
            <figcaption><a href="https://www.youtube.com/watch?v=j-ECPszC8x8">https://www.youtube.com/watch?v=j-ECPszC8x8</a></figcaption>
         </figure>
         <div class="youtube_toc">
            <ul>
               <li><a href="https://www.youtube.com/watch?v=j-ECPszC8x8">0:00 intro</a></li>
               <li><a href="https://www.youtube.com/watch?v=j-ECPszC8x8&t=30">0:30 gebruikte namespaces</a></li>
               <li>
                  <a href="https://www.youtube.com/watch?v=j-ECPszC8x8&t=187">3:07 demo: inlezen tekstbestand en regels weergeven in ListBox</a>
                  <ul>
                     <li><a href="https://www.youtube.com/watch?v=j-ECPszC8x8&t=197">3:17 random tekst genereren, lines.txt maken</a></li>
                     <li><a href="https://www.youtube.com/watch?v=j-ECPszC8x8&t=244">4:04 XAML aanmaken</a></li>
                     <li><a href="https://www.youtube.com/watch?v=j-ECPszC8x8&t=273">4:34 tekstbestand inlezen met StreamReader</a></li>
                     <li><a href="https://www.youtube.com/watch?v=j-ECPszC8x8&t=359">5:59 tekstbestand openen met OpenFileDialog</a></li>
                     <li><a href="https://www.youtube.com/watch?v=j-ECPszC8x8&t=448">7:28 tekstbestand inlezen ReadAllLines()</a></li>
                     <li><a href="https://www.youtube.com/watch?v=j-ECPszC8x8&t=549">9:09 tekstbestand inlezen ReadAllText()</a></li>
                  </ul>
               </li>
               <li>
                  <a href="https://www.youtube.com/watch?v=j-ECPszC8x8&t=660">11:00 demo uitbreiding</a>
                  <ul>
                     <li><a href="https://www.youtube.com/watch?v=j-ECPszC8x8&t=660">11:00 regel kunnen toevoegen</a></li>
                     <li><a href="https://www.youtube.com/watch?v=j-ECPszC8x8&t=761">12:41 opslaan met SaveFileDialog en WriteAllLines()</a></li>
                  </ul>
               </li>
            </ul>
         </div>
      </div>

      <h2>Namespaces en klassen</h2>
      <p>In .NET zit de functionaliteit voor het werken met bestanden en mappen verspreid over heel wat namespaces en klassen.</p>
      <h3>Voor paden</h3>
      <table class="light">
         <thead>
            <tr>
               <th scope="col">Klasse</th>
               <th scope="col">Omschrijving</th>
            </tr>
         </thead>
         <tbody>
            <tr>
               <td><code>System.IO.Path</code></td>
               <td>werken met paden; methodes <code>Combine()</code>, <code>GetFileNameWithoutExtension()</code>, <code>GetDirectoryName()</code>...</td>
            </tr>
            <tr>
               <td><code>System.Environment</code></td>
               <td>omgevingsspecifieke paden; methodes <code>GetFolderPath()</code>, properties <code>SpecialFolder.Desktop</code>, <code>SpecialFolder.MyDocuments</code>...</td>
            </tr>
         </tbody>
      </table>
      <h3>Voor bestanden en mappen</h3>
      <p>De meeste klassen voor het werken met bestanden en mappen vind je in de <code>System.IO</code> namespace:</p>
      <table class="light">
         <thead>
            <tr>
               <th scope="col">Klasse</th>
               <th scope="col">Omschrijving</th>
            </tr>
         </thead>
         <tbody>
            <tr>
               <td><code>Directory</code></td>
               <td>werken met mappen; methodes <code>GetDirectories()</code>, <code>GetFiles()</code>, <code>Delete()</code>, <code>CreateDirectory()</code>...</td>
            </tr>
            <tr>
               <td><code>DirectoryInfo</code></td>
               <td>map informatie opvragen; properties <code>FullName</code>, <code>Name</code>, <code>Parent</code>, <code>Exists</code>...</td>
            </tr>
            <tr>
               <td><code>File</code></td>
               <td>werken met bestanden; methodes <code>ReadAllText()</code>, <code>WriteAllText()</code>, <code>Copy()</code>, <code>Delete()</code>...</td>
            </tr>
            <tr>
               <td><code>FileInfo</code></td>
               <td>bestand informatie opvragen; properties <code>Name</code>, <code>Extension</code>, <code>Directory</code>, <code>Exists</code>, <code>Length</code>...</td>
            </tr>
            <tr class="pro">
               <td><code>StreamReader</code></td>
               <td>bestanden streamend lezen (geheugenvriendelijk, enkel nodig bij zeer grote bestanden)</td>
            </tr>
            <tr class="pro">
               <td><code>StreamWriter</code></td>
               <td>bestanden streamend schrijven (geheugenvriendelijk, enkel nodig bij zeer grote bestanden)</td>
            </tr>
            <tr>
               <td><code>System.IO.Path</code></td>
               <td>werken met paden; methodes <code>Combine()</code>, <code>GetFileNameWithoutExtension()</code>, <code>GetDirectoryName()</code>...</td>
            </tr>
         </tbody>
      </table>
      <h3>Voor dialoogvensters</h3>
      <p>Allerhande dialoogvensters vind je in <code>Microsoft.Win32</code>, <code>System.Windows</code> en <code>System.Windows.Forms</code>:</p>
      <table class="light">
         <thead>
            <tr>
               <th scope="col">Namespace</th>
               <th scope="col">Klasse</th>
               <th scope="col">Omschrijving</th>
            </tr>
         </thead>
         <tbody>
            <tr>
               <td>Microsoft.Win32</td>
               <td><code>OpenFileDialog</code></td>
               <td>dialoogvenster om bestanden te openen</td>
            </tr>
            <tr>
               <td>Microsoft.Win32</td>
               <td><code>OpenFolderDialog</code></td>
               <td>dialoogvenster om mappen te openen &mdash; pas beschikbaar vanaf .NET8!</td>
            </tr>
            <tr>
               <td>Microsoft.Win32</td>
               <td><code>SaveFileDialog</code></td>
               <td>dialoogvenster om bestanden op te slaan</td>
            </tr>
            <tr>
               <td>System.Windows</td>
               <td><code>MessageBox</code></td>
               <td>foutmeldings-, waarschuwings- en berichtvensters</td>
            </tr>
            <tr>
               <td>System.Windows.Forms</td>
               <td><code>FolderBrowserDialog</code></td>
               <td>ouderwets dialoogvenster om een map te kiezen</td>
            </tr>
         </tbody>
      </table>

      <h2>Paden</h2>
      <h3>Systeemmappen vinden</h3>
      <p>Op elke computer is de fysieke locatie voor systeemmappen als Desktop, My Documents... verschillend. Gebruik daarom altijd de <code>Environment.SpecialFolder</code> enumeratie:</p>
      <pre><code>string desktopFolder = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);</code></pre>
      <p>Andere typische voorbeelden zijn My Documents, My Pictures enz...:</p>
      <p><img src="img/09_bestanden/specialfolders.png" alt="" class="w-600"></p>

      <h3>Paden combineren</h3>
      <p>Gebruik best altijd <code>System.IO.Path.Combine()</code> om paden te combineren:</p>
      <pre><code>string folderPath = Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments);
string filePath = System.IO.Path.Combine(folderPath, "textfiles\\myfile.txt");
Console.WriteLine(filePath);
</code></pre>
      <figure class="console">
         <pre>C:\Users\rogie\Documents\textfiles\myfile.txt</pre>
         <figcaption>resultaat in de console</figcaption>
      </figure>

      <h2>Bestanden</h2>
      <h3>Overzicht</h3>
      <p>Alle methodes om bestanden te lezen, schrijven, bewerken enz... vind je in de <code>File</code> klasse:</p>
      <table class="light">
         <thead>
            <tr>
               <th scope="col">Methode</th>
               <th scope="col">Omschrijving</th>
            </tr>
         </thead>
         <tbody>
            <tr>
               <td><code>AppendAllLines()</code></td>
               <td>array of lijst toevoegen aan een bestand</td>
            </tr>
            <tr>
               <td><code>AppendAllText()</code></td>
               <td>tekst toevoegen aan een bestand</td>
            </tr>
            <tr>
               <td><code>Copy()</code></td>
               <td>kopieer een bestand</td>
            </tr>
            <tr>
               <td><code>Delete()</code></td>
               <td>verwijder een bestand</td>
            </tr>
            <tr>
               <td><code>Exists()</code></td>
               <td>controleert of een bestand bestaat</td>
            </tr>
            <tr>
               <td><code>Move()</code></td>
               <td>verplaats een bestand</td>
            </tr>
            <tr>
               <td><code>ReadAllLines()</code></td>
               <td>bestand inlezen in een <code>string[]</code> array</td>
            </tr>
            <tr>
               <td><code>ReadAllText()</code></td>
               <td>bestand inlezen in een <code>string</code></td>
            </tr>
            <tr>
               <td><code>WriteAllLines()</code></td>
               <td>array of lijst keer schrijven naar een bestand</td>
            </tr>
            <tr>
               <td><code>WriteAllText()</code></td>
               <td>tekst schrijven naar een bestand</td>
            </tr>
         </tbody>
      </table>
      <p>Properties om bestandsinformatie op te vragen vind je in de <code>FileInfo</code> klasse:</p>
      <table class="light">
         <thead>
            <tr>
               <th scope="col">Property</th>
               <th scope="col">Omschrijving</th>
            </tr>
         </thead>
         <tbody>
            <tr>
               <td><code>Directory</code></td>
               <td>map van het bestand (volledig pad)</td>
            </tr>
            <tr>
               <td><code>DirectoryName</code></td>
               <td>mapnaam van het bestand</td>
            </tr>
            <tr>
               <td><code>Exists</code></td>
               <td>bestaat het of niet (<code>true</code> of <code>false</code>)</td>
            </tr>
            <tr>
               <td><code>Extension</code></td>
               <td>extensie (met punt)</td>
            </tr>
            <tr>
               <td><code>FullName</code></td>
               <td>volledig pad</td>
            </tr>
            <tr>
               <td><code>Length</code></td>
               <td>bestandsgrootte in bytes</td>
            </tr>
            <tr>
               <td><code>Name</code></td>
               <td>bestandsnaam</td>
            </tr>
         </tbody>
      </table>

      <h3>Code voorbeelden</h3>
      <h4>Bestand inlezen in een string</h4>
      <pre><code>string folderPath = Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments);
string filePath = System.IO.Path.Combine(folderPath, "myfile.txt");

string inhoud = File.ReadAllText(filePath); // lees tekstinhoud bestand in
</code></pre>
      <h4>Bestand inlezen in een array</h4>
      <pre><code>string folderPath = Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments);
string filePath = System.IO.Path.Combine(folderPath, "myfile.txt");

string[] regels = File.ReadAllLines(filePath); // lees regels bestand in
</code></pre>
      <h4>String schrijven naar een bestand</h4>
      <pre><code>string folderPath = Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments);
string filePath = System.IO.Path.Combine(folderPath, "myfile.txt");
string inhoud = @"Dit is regel 1
Dit is regel 2";

File.WriteAllText(filePath, inhoud); // nieuw bestand als het nog niet bestaat
</code></pre>
      <h4>Array of lijst schrijven naar een bestand</h4>
      <pre><code>string folderPath = Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments);
string filePath = System.IO.Path.Combine(folderPath, "myfile.txt");
string[] regels = new string[] { "Dit is lijn 1", "Dit is lijn 2" };

File.WriteAllLines(filePath, regels); // nieuw bestand als het nog niet bestaat
</code></pre>
      <h4>Tekst toevoegen aan een bestaand bestand</h4>
      <p>Naast <code>File.WriteAllText()</code> en <code>File.WriteAllLines()</code> bestaan er ook methodes <code>File.AppendAllText()</code> en <code>File.AppendAllLines()</code>:</p>
      <pre><code>string folderPath = Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments);
string filePath = System.IO.Path.Combine(folderPath, "myfile.txt");

File.AppendAllText(filePath, $"Am no an listening depending up believing{Environment.NewLine}");</code></pre>
      <pre><code>string folderPath = Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments);
string filePath = System.IO.Path.Combine(folderPath, "myfile.txt");
string[] regels = new string[] { "Dit is lijn 3", "Dit is lijn 4" };

File.AppendAllLines(filePath, regels);
</code></pre>
      <h4>Controleren of een bestand bestaat</h4>
      <pre><code>string folderPath = Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments);
string filePath = System.IO.Path.Combine(folderPath, "mycontacts.txt");

if (!File.Exists(filePath))
{
   // ...
}</code></pre>

      <h4>Informatie opvragen</h4>
      <p>Twee klassen bieden gedeeltelijk overlappende functionaliteit voor het opvragen van informatie: <code>FileInfo</code> en <code>Path</code>.</p>
      <p>Codevoorbeeld met <code>FileInfo</code> (bestand &ldquo;test.txt&rdquo; op de Desktop):</p>
      <pre><code>string filePath = System.IO.Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.Desktop), "test.txt");
FileInfo fi = new FileInfo(filePath);
Console.WriteLine($@"
bestandsnaam: {fi.Name}
extensie: {fi.Extension}
gemaakt op: {fi.CreationTime.ToString()}
mapnaam: {fi.Directory.Name}
");</code></pre>
      <figure class="console">
         <pre>bestandsnaam: test.txt
extensie: .txt
gemaakt op: 24/10/2023 19:45:16
mapnaam: Desktop</pre>
         <figcaption>resultaat in de console</figcaption>
      </figure>
      <p>Codevoorbeeld met <code>Path:</code> (bestand &ldquo;test.txt&rdquo; op de Desktop):</p>
      <pre><code>string filePath = System.IO.Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.Desktop), "test.txt");
Console.WriteLine($@"
bestandsnaam: {Path.GetFileName(filePath)}
bestandsnaam zonder extensie: {Path.GetFileNameWithoutExtension(filePath)}
extensie: {Path.GetExtension(filePath)}
map: {Path.GetDirectoryName(filePath)}
");</code></pre>
      <figure class="console">
         <pre>bestandsnaam: test.txt
bestandsnaam zonder extensie: test
extensie: .txt
map: C:\Users\rogier\Desktop</pre>
         <figcaption>resultaat in de console</figcaption>
      </figure>
      <div class="pro">

         <h4>Streamend lezen en schrijven</h4>
         <p>Alle vorige methodes laden de hele bestandsinhoud in één keer in het geheugen in. Voor heel grote bestanden is dat niet efficiënt. In die (uitzonderlijke) gevallen kan je gebruik maken van <code>StreamReader</code> en <code>StreamWriter</code>. </p>
         <p><code>StreamReader</code> voorbeeld (zoeken naar een tekst):</p>
         <pre><code>List&lt;string&gt; foundLines = new List&lt;string&gt;();
string folderPath = Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments);
string filePath = System.IO.Path.Combine(folderPath, "mycontacts.txt");

// open stream and start reading
using (StreamReader reader = File.OpenText(filePath)) {
   string line;
   while ((line = reader.ReadLine()) != null) {
      if (line.Contains("jennifer")) foundLines.Add(line);
   }
} // stream closes automatically
</code></pre>
         <p><code>StreamWriter</code> voorbeeld:</p>
         <pre><code>// prepare
string folderPath = Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments);
string filePath = System.IO.Path.Combine(folderPath, "myfile.txt");

// open stream and start writing
using (StreamWriter writer = File.CreateText(filePath)) {
   writer.WriteLine("Dit is lijn 1");
   writer.WriteLine("Dit is lijn 2");
} // stream closes automatically
</code></pre>
         <p>In praktijk zul je streamend lezen of schrijven in deze cursus nooit nodig hebben.</p>
      </div>

      <h2>Mappen</h2>
      <h3>Overzicht</h3>
      <p>Alle methodes om te werken met mappen vind je in de <code>Directory</code> klasse:</p>
      <table class="light">
         <thead>
            <tr>
               <th scope="col">Methode</th>
               <th scope="col">Omschrijving</th>
            </tr>
         </thead>
         <tbody>
            <tr>
               <td><code>CreateDirectory()</code></td>
               <td>maak een map aan</td>
            </tr>
            <tr>
               <td><code>Delete()</code></td>
               <td>verwijder een map</td>
            </tr>
            <tr>
               <td><code>Exists()</code></td>
               <td>controleert of een map bestaat</td>
            </tr>
            <tr>
               <td><code>GetDirectories()</code></td>
               <td>vraag een lijst submappen in de map op</td>
            </tr>
            <tr>
               <td><code>GetFiles()</code></td>
               <td>vraag een lijst bestanden in de map op</td>
            </tr>
         </tbody>
      </table>
      <p>Properties om mapinformatie op te vragen vind je in de <code>DirectoryInfo</code> klasse:</p>
      <table class="light">
         <thead>
            <tr>
               <th scope="col">Property</th>
               <th scope="col">Omschrijving</th>
            </tr>
         </thead>
         <tbody>
            <tr>
               <td><code>Exists</code></td>
               <td>bestaat het of niet (<code>true</code> of <code>false</code>)</td>
            </tr>
            <tr>
               <td><code>FullName</code></td>
               <td>volledig pad</td>
            </tr>
            <tr>
               <td><code>Name</code></td>
               <td>bestandsnaam</td>
            </tr>
            <tr>
               <td><code>Parent</code></td>
               <td>basismap (volledig pad)</td>
            </tr>
         </tbody>
      </table>

      <h3>Code voorbeelden</h3>
      <h4>Map inhoud lezen</h4>
      <p>Gebruik de methodes <code>GetDirectories</code> en <code>GetFiles</code>. Voorbeeld voor het lezen van de bestanden op de desktop:</p>
      <pre><code>string desktop = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);

string[] files = Directory.GetFiles(desktop); // lijst van bestanden (volledig pad)
foreach (string file in files)
{
   Console.WriteLine(new FileInfo(file).Name); // geef enkel de namen weer
}</code></pre>
      <h4>Controleren of een map bestaat</h4>
      <pre><code>string folderPath = Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments);
string startfolder = System.IO.Path.Combine(folderPath, "myfolder");

if (!Directory.Exists(startfolder))
{
   // ...
}</code></pre>
      <h4>Informatie opvragen</h4>
      <p>Gebruik de <code>DirectoryInfo</code> klasse om informatie op te vragen. Schematisch codevoorbeeld (map &ldquo;Odisee&rdquo; op de desktop):</p>
      <pre><code>string folderPath = System.IO.Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.Desktop), "Odisee");
DirectoryInfo di = new DirectoryInfo(folderPath);
Console.WriteLine($@"
mapnaam: {di.Name}
basismap: {di.Parent.Name}
gemaakt op: {di.CreationTime}
");</code></pre>
      <figure class="console">
         <pre>mapnaam: Odisee
basismap: Desktop
gemaakt op: 29/01/2023 15:46:31</pre>
         <figcaption>resultaat in de console</figcaption>
      </figure>

      <h2>Dialoogvensters</h2>
      <h3>OpenFileDialog</h3>
      <p>Schematisch:</p>
      <pre><code>OpenFileDialog dialog = new OpenFileDialog();
dialog.InitialDirectory = Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments);
dialog.Filter = "Tekstbestanden|*.TXT;*.TEXT";
string chosenFileName;
bool? dialogResult = dialog.ShowDialog();
if (dialogResult == true) {
   // user picked a file and pressed OK
   chosenFileName = dialog.FileName;
} else {
   // user cancelled or escaped dialog window
}
</code></pre>
      <p><img src="img/09_bestanden/openfiledialog.png" alt="" class="w-550"></p>
      <h3>OpenFolderDialog</h3>
      <p><strong>Let op!</strong> Tot voor kort bestond (zeer vreemd genoeg) dit dialoogvenster niet. Het is pas toegevoegd sinds .NET8, dus werkt niet in oudere projecttypes als WPF .NET Framework! Daar werd je verondersteld third party oplossingen te gebruiken. Schematisch:</p>
      <pre><code>OpenFolderDialog dialog = new OpenFolderDialog();
dialog.InitialDirectory = Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments);
string chosenFolderName;
bool? dialogResult = dialog.ShowDialog();
if (dialogResult == true)
{
   // user picked a folder and pressed OK
   chosenFolderName = dialog.FolderName;
}
else
{
   // user cancelled or escaped dialog window
}</code></pre>
      <p><img src="img/09_bestanden/openfolderdialog.png" alt="" class="w-550"></p>
      <h3>SaveFileDialog</h3>
      <p>Schematisch:</p>
      <pre><code>SaveFileDialog dialog = new SaveFileDialog();
dialog.InitialDirectory = Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments);
dialog.Filter = "Tekstbestanden|*.TXT;*.TEXT";
dialog.FileName = "savedfile.txt";
if (dialog.ShowDialog() == true) {
   File.WriteAllText(dialog.FileName, "tekstinhoud hier");
} else {
   // user pressed Cancel or escaped dialog window
}
</code></pre>
      <p><img src="img/09_bestanden/savefiledialog.png" alt="" class="w-550"></p>
      <h3>MessageBox</h3>
      <p>Zie <a href="A_dotnet.html#messagebox">.NET classes - MessageBox</a></p>

      <h2>Exception handling</h2>
      <h3>Wanneer gebruiken</h3>
      <p>De regel wanneer wel en wanneer niet te gebruiken is heel eenvoudig:</p>
      <div class="tips" data-caption="✊🏻REGEL">
         <p>Gebruik Exception handling enkel voor <strong>externe fouten</strong> waar je <strong>geen controle</strong> over hebt en die op <strong>geen andere manier</strong> op te vangen zijn, <em>niet</em> om mogelijke fouten in je eigen code weg te moffelen!</p>
      </div>
      <p>Gebruik het dus enkel in situaties waar je zelf <em>echt niks anders aan kan doen</em>:</p>
      <ul class="right">
         <li><strong>lezen/schrijven bestanden en mappen</strong>: I/O problemen, b.v. geen schrijfrechten</li>
         <li><strong>databank operaties</strong>: kan offline zijn of niet reageren, er kan een fout optreden bij uitvoeren query...</li>
         <li><strong>netwerk operaties</strong>: idem</li>
         <li><strong>gebruik externe bibliotheken</strong>: kunnen fouten maken of zelf excepties genereren</li>
         <li><strong>validatie externe data</strong>: bij parsen JSON, XML, input van de gebruiker...</li>
         <li>...</li>
      </ul>
      <p>Gebruik het niet wanneer er alternatieven bestaan:</p>
      <ul class="wrong">
         <li>bestanden of mappen die niet gevonden worden (gebruik <code>File.Exists()</code> of <code>Directory.Exists()</code>)</li>
         <li>situaties die evengoed met een if-else kunnen opgevangen worden</li>
         <li>rond een codeblok waarvan je niet helemaal zeker bent dat er geen fouten in staan (schrijf gewoon betere code!)</li>
         <li>...</li>
      </ul>
      <h3>Hoe gebruiken</h3>
      <h4>Enkel indien echt nodig</h4>
      <p>Als er een evenwaardig alternatief bestaat, mag je het niet gebruiken. Twee voorbeelden:</p>
      <div class="codecompare">
         <pre class="wrong"><code>try
{
   int[] numbers = new int[3];
   Console.WriteLine(numbers[5]); // Index out of bounds
}
catch (IndexOutOfRangeException ex)
{
   Console.WriteLine("Handled out-of-bounds access");
}</code></pre>
         <pre class="right"><code>int[] numbers = new int[3];
if (numbers.Length &gt; 5)
{
   Console.WriteLine(numbers[5]);
}
else
{
   Console.WriteLine("Index out of range");
}</code></pre>
      </div>
      <div class="codecompare">
         <pre class="wrong"><code>try
{
   string content = File.ReadAllText("somefile.txt");
}
catch (FileNotFoundException)
{
   Console.WriteLine("File not found");
}</code></pre>
         <pre class="right"><code>if (File.Exists("somefile.txt"))
{
   string content = File.ReadAllText("somefile.txt");
}
else
{
   Console.WriteLine("File not found");
}</code></pre>
      </div>
      <div class="codecompare">
         <pre class="wrong"><code>int num;
try
{
   int num = int.Parse(Console.ReadLine());
}
catch (FormatException)
{
   Console.WriteLine("Invalid format");
}</code></pre>
         <pre class="right"><code>int num;
if (!int.TryParse(Console.ReadLine(), out num))
{
   Console.WriteLine("Invalid format");
}</code></pre>
      </div>
      <h4>Zinvolle <code>catch</code></h4>
      <p>Een <code>try</code> zonder zinvolle <code>catch</code> verbergt gewoon de fout, en dat is niet de bedoeling:</p>
      <div class="codecompare">
         <pre class="wrong"><code>try
{
   File.Delete("somefile.txt");
}
catch
{
   // geen logging, geen actie ondernomen
}
</code></pre>
         <pre class="right"><code>try
{
   File.Delete("somefile.txt");
}
catch (IOException e)
{
   Console.WriteLine($"Er is een fout opgetreden: {e.Message}")
}</code></pre>
      </div>

      <h4>Specifieke exceptietypes</h4>
      <div class="codecompare">
         <pre class="wrong"><code>try
{
   string content = File.ReadAllText("somefile.txt");
}
catch (Exception ex) // te breed
{
   Console.WriteLine("An error occurred");
}
</code></pre>
         <pre class="right"><code>try
{
   string content = File.ReadAllText("somefile.txt");
}
catch (IOException) // ok, specifiek genoeg
{
   Console.WriteLine("Fout bij het lezen van het bestand");
}</code></pre>
      </div>
      <h4>Meerdere <code>catch</code>-blokken</h4>
      <p>Overweeg meerdere <code>catch</code>-blokken, met exceptietypes van specifiek naar algemeen:</p>
      <pre class="right"><code>string content;
string folderPath = Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments);
string filePath = System.IO.Path.Combine(folderPath, "myfile.txt");
try {
   content = File.ReadAllText(filePath);
} catch (FileNotFoundException e) { // file not found
   lblMessage.Content = $"File {filePath} not found";
} catch (IOException e) { // unable to open for reading
   lblMessage.Content = $"Unable to open {filePath}";
} catch (Exception e) { // use general Exception as fallback
   lblMessage.Content = $"Unknown error reading {filePath}";
}
// process content
// ...
</code></pre>
      <p>Merk op dat hoewel de <code>FileNotFoundException</code> in principe kan vervangen worden door een <code>if (!File.Exists(filePath)) ...</code>, het gebruik hier te verdedigen is omdat er al een try-catch blok voorkomt.</p>

      <h4>Beperkte <code>try</code>-blok</h4>
      <p>Zet niet meer code in het <code>try</code>-blok dan strikt nodig:</p>
      <div class="codecompare">
         <pre class="wrong"><code>try {
   string content;
   string folderPath = Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments);
   string filePath = System.IO.Path.Combine(folderPath, "myfile.txt");
   content = File.ReadAllText(filePath);
   // process content
   // ...
} catch (FileNotFoundException e) { // file not found
   lblMessage.Content = $"File {filePath} not found";
} catch (IOException e) { // unable to open for reading
   lblMessage.Content = $"Unable to open {filePath}";
} catch (Exception e) { // use general Exception as fallback
   lblMessage.Content = $"Unknown error reading {filePath}";
}</code></pre>
         <pre class="right"><code>string content;
string folderPath = Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments);
string filePath = System.IO.Path.Combine(folderPath, "myfile.txt");
try {
   content = File.ReadAllText(filePath);
} catch (FileNotFoundException e) { // file not found
   lblMessage.Content = $"File {filePath} not found";
} catch (IOException e) { // unable to open for reading
   lblMessage.Content = $"Unable to open {filePath}";
} catch (Exception e) { // use general Exception as fallback
   lblMessage.Content = $"Unknown error reading {filePath}";
}
// process content
// ...
</code></pre>
      </div>
      <h4>Zo laat mogelijk (meestal)</h4>
      <p>Een vuistregel is dat het beter is de </p>

      <h3>Finally</h3>
      <p>Het <code>finally</code>-blok wordt <em>altijd</em> uitgevoerd op het einde van het try-catch blok, wat er ook gebeurt. Dit verzekert b.v. dat bronnen correct afgesloten worden:</p>
      <pre class="right"><code>string content;
try
{
   reader = new StreamReader("somefile.txt");
   content = reader.ReadToEnd();
}
catch (FileNotFoundException)
{
   Console.WriteLine($"Bestand niet gevonden");
}
catch (IOException ex)
{
   Console.WriteLine($"Fout bij lezen: {ex.Message}");
}
finally
{
   reader.Close(); // bestand wordt gesloten, zelfs als een exceptie optreedt
   Console.WriteLine("File closed.");
}</code></pre>

      <h3>Throw</h3>
      <p>Je kan ook zelf excepties opgooien. Wil je b.v. een methodes al declareren, maar de body pas later uitwerken, dan kan je tijdelijk <code>NotImplementedException</code> gebruiken</p>
      <pre><code>public static User TryLogin(string login, string pw) {
   throw new NotImplementedException("Deze feature is nog niet geïmplementeerd");
}
public static User FindUser(int id) {
   throw new NotImplementedException("Deze feature is nog niet geïmplementeerd");
}
public static void Delete() {
   throw new NotImplementedException("Deze feature is nog niet geïmplementeerd");
}
// ...</code></pre>
      <p>In een tweede voorbeeld worden in een methode <code>FindKeywordInFile()</code> niet alleen excepties opgevangen, maar ook opgegooid, zodat ze hoger in de <code>Main()</code> weer kunnen opgevangen en afgehandeld worden:</p>
      <pre><code>static void Main() {
   try {
      int lineNumber = FindKeywordInFile("sample.txt", "keyword");
   }
   catch (FileNotFoundException ex) {
      Console.WriteLine($"Fout: {ex.Message}");
   }
   catch (IOException ex) {
      Console.WriteLine($"Fout: {ex.Message}");
   }
   catch (Exception ex) {
      Console.WriteLine($"Onverwachte fout: {ex.Message}");
   }
}

static int FindKeywordInFile(string filePath, string keyword) {
   if (!File.Exists(filePath)) {
      throw new FileNotFoundException($"Bestand '{filePath}' niet gevonden.");
   }
   if (string.IsNullOrWhiteSpace(keyword)) {
      throw new ArgumentException("De zoekterm mag niet null of leeg zijn.");
   }
   try {
      string[] lines = File.ReadAllLines(filePath);
      for (int i = 0; i &lt; lines.Length; i++) {
         if (lines[i].Contains(keyword)) {
               return i + 1;  // gevonden op regel i + 1
         }
      }
      return -1; // keyword niet gevonden
   }
   catch (IOException) {
      throw new IOException($"Kan het bestand '{filePath}' niet lezen.");
   }
   catch (Exception ex) {
      throw new Exception("Een onbekende fout is opgetreden.", ex);
   }
}</code></pre>
   <p>Je kan je de vraag stellen wat voor zin het heeft een exceptie te catchen, en dezelfde exceptie weer te throwen:</p>
   <pre><code>static int FindKeywordInFile(string filePath, string keyword) {
   ...
   catch (IOException) {
      throw new IOException($"Kan het bestand '{filePath}' niet lezen.");
   }
   ...
}</code></pre>
      <p>Op zich kan je dit weglaten; dit werkt evengoed:</p>
      <pre><code>static void Main() {
   try {
      int lineNumber = FindKeywordInFile("sample.txt", "keyword");
   }
   catch (FileNotFoundException ex) {
      Console.WriteLine($"Fout: {ex.Message}");
   }
   catch (IOException ex) {
      Console.WriteLine($"Fout: {ex.Message}");
   }
   catch (Exception ex) {
      Console.WriteLine($"Onverwachte fout: {ex.Message}");
   }
}

static int FindKeywordInFile(string filePath, string keyword) {
   if (!File.Exists(filePath)) {
      throw new FileNotFoundException($"Bestand '{filePath}' niet gevonden.");
   }
   if (string.IsNullOrWhiteSpace(keyword)) {
      throw new ArgumentException("De zoekterm mag niet null of leeg zijn.");
   }
   string[] lines = File.ReadAllLines(filePath);
   for (int i = 0; i &lt; lines.Length; i++) {
      if (lines[i].Contains(keyword)) {
            return i + 1;  // gevonden op regel i + 1
      }
   }
   return -1; // keyword niet gevonden
}</code></pre>
      <p>Excepties catchen en weer opgooien is alleen nuttig in volgende situaties:</p>
      <ul>
         <li>aangepaste foutmelding: voeg meer details toe, b.v. om welk bestand het gaat</li>
         <li>aangepaste exceptie type: catch één exceptie type, en throw een ander (b.v. custom) type</li>
         <li>extra acties: je kan bijkomend de fouten loggen, resources vrijgeven enz...</li>
      </ul>
      <p>Maar als je niks toevoegt, heeft een exceptie opvangen en weer opgooien geen zin natuurlijk:</p>
      <pre class="wrong"><code>...
catch (IOException ex) {
   throw ex; // pretty pointless
}
...
</code></pre>



   </main>
   <footer>
      <img src="common/img/thats-all.jpg" alt="">
      <div class="footer__bottom">
         <p>@2024, Rogier van der Linde</p>
         <p>cursussen in dezelfde reeks: <a href="https://rogiervdl.github.io/HTML-course/">HTML</a> &mdash; <a href="https://rogiervdl.github.io/CSS-course/">CSS</a> &mdash; <a href="https://rogiervdl.github.io/JS-course/">Javascript</a> &mdash; <a href="https://rogiervdl.github.io/DEVENV-course/">Ontwikkelomgeving</a></p>
      </div>
   </footer>
   <a aria-label="up" id="up" href="#top"><span class="fas fa-chevron-circle-up"></span></a>
   <script src="common/vendor/prism/prism.js"></script>
   <script src="common/js/mode.js"></script>
   <script src="common/js/scripts.js"></script>
   <!-- Google tag (gtag.js) -->
   <script async src="https://www.googletagmanager.com/gtag/js?id=G-Q7JWZ9HHW0"></script>
   <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() { dataLayer.push(arguments); }
      gtag('js', new Date());

      gtag('config', 'G-Q7JWZ9HHW0');
   </script>
</body>

</html>
